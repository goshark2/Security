
Recently, I completed the Compromised Windows Analysis room on TryHackMe, and it was an incredibly insightful dive into Windows Forensics and Incident Response. 
Here Iâ€™ll walk through the key investigation steps, forensic tools, and the attackerâ€™s full timeline I uncovered during the challenge.
This challenge was an excellent hands-on experience in:

Using Eric Zimmerman tools like LECmd, PECmd, AmcacheParser

Parsing and correlating LNK, Prefetch, and Amcache artifacts

Investigating Scheduled Tasks and Windows Event Logs

Reconstructing a complete attack timeline
# **Tools Used**
Eric Zimmerman's Tools

Windows Event Viewer

Timeline Explorer
Scenario:

TKM, a small tech startup, detected suspicious SSH traffic to a known malicious IP from one of its employee's machines (Aashirâ€™s host). The junior security engineer, Joe, noticed:

**SSH connection attempts every minute**

Windows Defender was disabled

The user was unaware of any such activity

A recurring prompt showed up every minute

Joe quickly blocked the IP, contained the host, and escalated for a deeper investigation. Thatâ€™s where we step in as forensic investigators.

To analyze the compromise, we relied on Eric Zimmermanâ€™s forensic tools and a structured investigation approach using several key Windows artifacts.
Step 1: Scheduled Tasks â€“ Persistence Mechanism
We suspected the recurring prompt every minute was tied to a Scheduled Task.

We opened Task Scheduler and confirmed a task was created at 10:29 AM, intended to reach out to the C2 server via SSH on a one-minute interval.

This indicated persistence and possibly automated command executio
Step 2: LNK Files â€“ Tracking File Access
We checked .LNK (shortcut) files to determine what files were accessed before the scheduled task creation.

Located in: C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Recent Items

We found an LNK pointing to a RAR file accessed at 10:27 AMâ€”just two minutes before the scheduled task was created.

However, the original RAR file had been deleted.

Step 3: LECmd â€“ Parsing LNK Files
Using LECmd, we parsed the LNK files:
cd "C:\Users\Administrator\Desktop\Forensics Tools\LECmd"
.\LECmd.exe -d C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Recent --csvf Parsed-LNK.csv --csv C:\Users\Administrator\Desktop
Imported the results into Timeline Explorer to visualize the activity timeline.

We confirmed:

File accessed at 10:27

Target: A suspicious RAR archive
Step 4: Prefetch Files â€“ Program Execution
Next, we parsed Prefetch files using PECmd to confirm if any executables from the RAR were launched.
cd "C:\Users\Administrator\Desktop\Forensics Tools\PECmd"
.\PECmd.exe -d "C:\Windows\Prefetch" --csv C:\Users\Administrator\Desktop --csvf Prefetch-Parsed.csv

results were visualized via Timeline Explorer.

We saw a suspicious executable was run immediately after the RAR file was accessedâ€”likely the malicious payload.

Step 5: Amcache â€“ File Metadata & Hashes
We leveraged Amcache to find metadata like full path and hash of the executed file:

Pre-parsed file Amcache-Parsed.csv was available on Desktop.
It revealed:

Full path to the executable

SHA1 hash

Execution time consistent with previous evidence

Step 6: Windows Event Logs â€“ RDP & Defender Tampering
Using Event Viewer, we uncovered more breadcrumbs:
RDP Logon (Event ID 1149) â€“ successful RDP session just before the RAR file was accessed.

ðŸ”´ Windows Defender Disabled (Event ID 5001) â€“ confirming tampering to avoid detection.
